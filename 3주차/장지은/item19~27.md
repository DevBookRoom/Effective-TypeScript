## item19. ì¶”ë¡  ê°€ëŠ¥í•œ íƒ€ì…ì„ ì‚¬ìš©í•´ ì¥í™©í•œ ì½”ë“œ ë°©ì§€í•˜ê¸°

### TSê°€ ì¶”ë¡  ê°€ëŠ¥í•œ ê²½ìš°ë“¤

íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ê°€ ì¶”ë¡  ê°€ëŠ¥í•œ íƒ€ì…ë“¤ì€ íƒ€ì…êµ¬ë¬¸ì´ ì‚¬ì‹¤ ë¶ˆí•„ìš”í•˜ë‹¤.

```tsx
let x = 12; // x:numberë¡œ ì´ë¯¸ ì¶”ë¡ ë˜ì–´ìˆìŒ

const person = {
  name: "í™ê¸¸ë™", // name: string
  born: {
    where: "ì„œìš¸", // where: string
    when: "2023-01-01", // when: string
  },
};
```

í•¨ìˆ˜ì˜ ë¦¬í„´íƒ€ì…ì´ ëª…í™•í•œ ê²½ìš°ì—ë„, íƒ€ì…ì¶”ë¡ ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ë”°ë¡œ ëª…ì‹œí•  í•„ìš”ê°€ ì—†ë‹¤.

```tsx
function square(nums: number[]) {
  return nums.map((num) => num * num);
}

const squareNumbers = square([1, 2, 3, 4, 5]); // squareNumbers: number[]ë¡œ ì´ë¯¸ ì¶”ë¡ 
```

ë§¤ê°œë³€ìˆ˜ì— ê¸°ë³¸ê°’ì´ ìˆëŠ” ê²½ìš°ë„ íƒ€ì…êµ¬ë¬¸ ìƒëµ ê°€ëŠ¥

```tsx
function parseNumber(str: string, base = 10) {
  // base: numberë¡œ ìë™ ì¶”ë¡ 
  return parseInt(str, base);
}
```

íƒ€ì…ì •ë³´ê°€ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ì½œë°±í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜íƒ€ì…ì€ ìë™ìœ¼ë¡œ ì¶”ë¡ ëœë‹¤.

```tsx
// âŒ express HTTP ì„œë²„ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ í•´ë‹¹ íƒ€ì…ì„ ì–¸ì€ ë¶ˆí•„ìš”í•¨
app.get("/health", (req: express.Request, res: express.Response) => {
  res.send("ok");
});

// âœ… íƒ€ì…ì„ ì–¸ ì—†ì–´ë„ ì¶”ë¡  ê°€ëŠ¥í•˜ë‹¤
app.get("/health", (req, res) => {
  res.send("ok");
});
```

### ë¹„êµ¬ì¡°í™” í• ë‹¹ë¬¸ í™œìš©

íƒ€ì…ì´ ì¶”ë¡ ë˜ë©´ íƒ€ì…ì„ ëª…ì‹œí•˜ì§€ ì•ŠëŠ”ê²ƒì´ ë¦¬íŒ©í† ë§ë„ ë” ì‰¬ì›Œì§„ë‹¤.

```tsx
interface Product {
  id: number;
  name: string;
  price: number;
}
```

íƒ€ì… ëª…ì‹œí•œ ì¼€ì´ìŠ¤

```tsx
function logProduct(product: Product) {
  const id: number = product.id;
  const name: string = product.name;
  const price: number = product.price;
  console.log(`${id} ${name}ì˜ ê°€ê²©ì€ ${price}ì›ì…ë‹ˆë‹¤.`);
}
```

- idê°€ stringìœ¼ë¡œ ë°”ë€” ê²½ìš°, logProduct í•¨ìˆ˜ ë‚´ì˜ íƒ€ì…ê¹Œì§€ ìˆ˜ì • í•„ìš”

ë¹„êµ¬ì¡°í™” í• ë‹¹ë¬¸

```tsx
function logProduct2(product: Product) {
  const { id, name, price } = product;
  console.log(`${id} ${name}ì˜ ê°€ê²©ì€ ${price}ì›ì…ë‹ˆë‹¤.`);
}
```

- ë¹„êµ¬ì¡°í™” í• ë‹¹ë¬¸ì€ ë³€ìˆ˜ì˜ íƒ€ì…ì´ ì¶”ë¡ ë˜ë„ë¡ í•¨
- ë§¤ê°œë³€ìˆ˜ì˜ íƒ€ì… Productë§Œ ì§€ì •í•˜ëŠ”ê²ƒìœ¼ë¡œ ì¶©ë¶„í•˜ë‹¤!
- idê°€ stringìœ¼ë¡œ ë°”ë€Œì–´ë„, í•´ë‹¹ í•¨ìˆ˜ëŠ” ìˆ˜ì •ë  í•„ìš”âŒ, ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ì›Œì§„ë‹¤

### íƒ€ì… ëª…ì‹œí•˜ëŠ”ê²Œ ì¢‹ì€ ì¼€ì´ìŠ¤

ê°ì²´ ë¦¬í„°ëŸ´ ì •ì˜í•  ë• íƒ€ì…ì„ ëª…ì‹œí•˜ëŠ”ê²Œ ì¢‹ë‹¤. ë§Œì•½ ê°ì²´ë¦¬í„°ëŸ´ì„ ì„ ì–¸í•  ë•Œ íƒ€ì…êµ¬ë¬¸ì„ ì œê±°í•œë‹¤ë©´, ê°ì²´ë¥¼ ì„ ì–¸í•œ ê³³ì´ ì•„ë‹ˆë¼ ì‚¬ìš©ë˜ëŠ” ê³³ì—ì„œ íƒ€ì…ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

```tsx
interface Product {
  id: string;
  name: string;
  price: number;
}

// ê°ì²´ ë¦¬í„°ëŸ´ì— íƒ€ì…êµ¬ë¬¸X
const furby = {
  id: 200222, // idë¥¼ stringì´ ì•„ë‹Œ numberë¡œ ì„ ì–¸!
  name: "Furby",
  price: 20000,
};
logProduct(furby); // âŒ ì„ ì–¸ë¶€ê°€ ì•„ë‹ˆë¼ ì‹¤ì œ ì‚¬ìš©í•˜ëŠ” ê³³ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤! - ë””ë²„ê¹… ì–´ë ¤ì›€
```

í•¨ìˆ˜ ë°˜í™˜íƒ€ì… ëª…ì‹œí•˜ë©´ ì˜¤ë¥˜ë¥¼ ì‚¬ì „ì— ë°œê²¬í•˜ì—¬ ì—ëŸ¬ë°©ì§€í•  ìˆ˜ ìˆë‹¤.

ì¡°ê±´ì— ë”°ë¼ ë¦¬í„´íƒ€ì…ì´ ë‹¤ë¥´ê²Œ ë‚˜ì˜¤ì§€ë§Œ, return typeì„ ëª…ì‹œí•˜ì§€ ì•Šì•„ tsëŠ” ì—ëŸ¬ë¥¼ ì¡ì•„ì£¼ì§€ ì•ŠëŠ”ë‹¤.

```tsx
const cache: { [ticker: string]: number } = {};
function getQuote(ticker: string) {
  if (cache[ticker]) {
    // â“â“â“ return number
    return cache[ticker];
  }
  // â“â“â“ return Promise<number>
  return fetch("https://api.example.com/quote?ticker=" + ticker)
    .then((response) => response.json())
    .then((data) => {
      cache[ticker] = data;
      return data;
    });
}
```

ë¦¬í„´íƒ€ì…ì„ ëª…ì‹œí•˜ë©´ í•´ë‹¹ ì˜¤ë¥˜ë¥¼ ë¯¸ë¦¬ ë°œê²¬í•  ìˆ˜ ìˆë‹¤!

```tsx
const cache: { [ticker: string]: number } = {};
function getQuote(ticker: string): Promise<number> {
  if (cache[ticker]) {
    // return cache[ticker]; // âŒ ì˜¤ë¥˜ë°œìƒ!! - Type 'number' is not assignable to type 'Promise<number>'.
    return Promise.resolve(cache[ticker]); // âœ… í•´ê²°ë°©ë²• - Promise.resolveë¥¼ ì‚¬ìš©í•˜ì—¬ ì¦‰ì‹œ í•´ê²°
  }
  return fetch("https://api.example.com/quote?ticker=" + ticker)
    .then((response) => response.json())
    .then((data) => {
      cache[ticker] = data;
      return data;
    });
}
```

---

## item20. ë‹¤ë¥¸ íƒ€ì…ì—ëŠ” ë‹¤ë¥¸ ë³€ìˆ˜ ì‚¬ìš©í•˜ê¸°

```tsx
// âŒ Don't
let id = "12-34-56";
fetchProduct(id);
id = 123456;
fetchProductBySerialNumber(id);
```

```tsx
// âœ… Do
const id = "123456"; // string
fetchProduct(id);
const serial = 123456; // number
fetchProductBySerialNumber(serial);
```

- ì„œë¡œ ê´€ë ¨ì—†ëŠ” ê°’ì€ ë¶„ë¦¬í•œë‹¤ (id, serial)
- ë³€ìˆ˜ëª…ì€ êµ¬ì²´ì ìœ¼ë¡œ ì§“ëŠ”ë‹¤
- íƒ€ì…ì¶”ë¡ ì„ í–¥ìƒì‹œí‚¤ë©´ íƒ€ì…êµ¬ë¬¸ì´ ë¶ˆí•„ìš”í•´ì§€ê³ , íƒ€ì…ì´ ë” ê°„ê²°í•´ì§„ë‹¤
- let ëŒ€ì‹  constë¡œ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ê²Œ ë˜ê³ , ì´ëŠ” íƒ€ì…ì²´ì»¤ê°€ íƒ€ì…ì„ ì¶”ë¡ í•˜ê¸° ì¢‹ë‹¤

---

## item21. íƒ€ì… ë„“íˆê¸°

### íƒ€ì… ë„“íˆê¸°ë€?

ìƒìˆ˜ë¥¼ ì´ìš©í•´ì„œ ë³€ìˆ˜ë¥¼ ì´ˆê¸°í™”í•  ë•Œ íƒ€ì…ì„ ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ íƒ€ì…ì²´ì»¤ëŠ” íƒ€ì…ì„ ê²°ì •í•´ì•¼ í•œë‹¤.

ì¦‰, ì§€ì •ëœ ë‹¨ì¼ê°’ì„ ê°€ì§€ê³  í• ë‹¹ ê°€ëŠ¥í•œ ê°’ë“¤ì˜ ì§‘í•©ì„ ìœ ì¶”í•´ì•¼í•œë‹¤. == TSì˜ ë„“íˆê¸° ê³¼ì • (widening)

```tsx
interface Vector3 {
  x: number;
  y: number;
  z: number;
}
function getComponent(vector: Vector3, axis: "x" | "y" | "z") {
  return vector[axis];
}

let x = "x"; // ë„“íˆê¸° ì‹œì ì— stringìœ¼ë¡œ ì¶”ë¡ ë¨
let vec = { x: 1, y: 2, z: 3 };
getComponent(vec, x); // âŒ ì˜¤ë¥˜ë°œìƒ! - Argument of type 'string' is not assignable to parameter of type '"x" | "y" | "z"'
```

xëŠ” í• ë‹¹ ì‹œì ì— ë„“íˆê¸° ê³¼ì •ì„ í†µí•´ stringìœ¼ë¡œ ì¶”ë¡ ë˜ì§€ë§Œ, getComponentì˜ axis "x" | "y" | "z"íƒ€ì…ì— í• ë‹¹ì´ ë¶ˆê°€ëŠ¥í•˜ì—¬ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

### íƒ€ì… ë„“íˆê¸° ì œì–´í•˜ê¸°

constë¥¼ ì´ìš©í•˜ë©´ ë„“íˆê¸° ê³¼ì •ì„ ì œì–´í•  ìˆ˜ ìˆë‹¤.

let ëŒ€ì‹  constë¡œ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ë©´, í•´ë‹¹ ë³€ìˆ˜ëŠ” ì¬í• ë‹¹ ë  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ë” ì¢ì€ íƒ€ì…ì´ ëœë‹¤.

```tsx
const x = "x"; // âœ¨ constë¡œ ì„ ì–¸í•˜ì—¬ stringì´ ì•„ë‹ˆë¼ "x"íƒ€ì…ìœ¼ë¡œ í• ë‹¹ë¨
let vec = { x: 1, y: 2, z: 3 };
getComponent(vec, x); // âœ… ì˜¤ë¥˜ ì—†ìŒ
```

ê°ì²´ì™€ ë°°ì—´ì˜ ê²½ìš°ì—” constë¡œë„ ì œì–´ê°€ ë˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆë‹¤.

TSë„“íˆê¸° ì•Œê³ ë¦¬ì¦˜ì€ ê°ì²´ì˜ ê° ìš”ì†Œë¥¼ letìœ¼ë¡œ í• ë‹¹ëœ ê²ƒì²˜ëŸ¼ ë‹¤ë£¬ë‹¤.

```tsx
const v = { x: 1 }; // xëŠ” letì²˜ëŸ¼ ë‹¤ë£¨ì–´ì§ => x: number

v.x = 2; // âœ… ì˜¤ë¥˜ ì—†ìŒ - xëŠ” numberíƒ€ì…ì´ë¯€ë¡œ í• ë‹¹ ê°€ëŠ¥
v.x = "x"; // âŒ ì˜¤ë¥˜ë°œìƒ! - Type 'string' is not assignable to type 'number'.
v.y = 4; // âŒ ì˜¤ë¥˜ë°œìƒ! - Property 'y' does not exist on type '{ x: number; }'.
v.name = "rachel"; // âŒ ì˜¤ë¥˜ë°œìƒ! - Property 'name' does not exist on type '{ x: number; }'.
```

ê°ì²´/ë°°ì—´ì˜ íƒ€ì…ì¶”ë¡ ì˜ ê°•ë„ë¥¼ ì§ì ‘ ì œì–´í•˜ëŠ” ë°©ë²•ì€

1. ëª…ì‹œì  íƒ€ì…êµ¬ë¬¸ì„ ì œê³µí•˜ê¸°

   ```tsx
   const v: { x: 1 | 3 | 5 } = {
     x: 1,
   }; // vì˜ íƒ€ì…ì€ { x: 1|3|5}
   ```

2. íƒ€ì…ì²´ì»¤ì— ì¶”ê°€ì ì¸ ë¬¸ë§¥ì„ ì œê³µí•˜ê¸° (í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ê°’ ì „ë‹¬ ë“±) â†’ item26 íƒ€ì…ì¶”ë¡ ê³¼ì •ì—ì„œ ìì„¸íˆ ë‹¤ë£¸
3. const ë‹¨ì–¸ë¬¸ ì‚¬ìš©í•˜ê¸°

   ```tsx
   const v1 = {
     x: 1,
     y: 2,
   }; // v1ì˜ íƒ€ì…ì€ { x: number, y: number }

   const v2 = {
     x: 1 as const,
     y: 2,
   }; // v2ì˜ íƒ€ì…ì€ { x: 1, y: number }

   const v3 = {
     x: 1,
     y: 2,
   } as const; // v3ì˜ íƒ€ì…ì€ { readonly x: 1, readonly y: 2 }
   ```

   ```
   const a1 = [1, 2, 3]; // a1ì˜ íƒ€ì…ì€ (number)[]
   const a2 = [1, 2, 3] as const; // a2ì˜ íƒ€ì…ì€ readonly [1, 2, 3]
   ```

   ê°’ ë’¤ì— as constë¥¼ ì‘ì„±í•˜ë©´, TSëŠ” ìµœëŒ€í•œ ì¢ì€ íƒ€ì…ìœ¼ë¡œ ì¶”ë¡ í•œë‹¤. as constë¥¼ ì‚¬ìš©í•˜ì—¬ ë„“íˆê¸°ë¡œ ì¸í•œ ì˜¤ë¥˜ë¥¼ ì¤„ì¼ ìˆ˜ ìˆë‹¤.

---

## item22. íƒ€ì… ì¢íˆê¸°

íƒ€ì… ì¢íˆê¸°ëŠ” TSê°€ ë„“ì€ íƒ€ì…ìœ¼ë¡œë¶€í„° ì¢ì€ íƒ€ì…ìœ¼ë¡œ ì§„í–‰í•˜ëŠ” ê³¼ì •ì„ ë§í•œë‹¤.

### nullì²´í¬

nullì²´í¬ëŠ” ëŒ€í‘œì ì¸ íƒ€ì…ì¢íˆê¸°ì˜ ì˜ˆì‹œì´ë‹¤. ë¶„ê¸°ì— ë”°ë¼ ë³€ìˆ˜ì˜ íƒ€ì…ì„ ì¢í˜€ ì¶”ë¡ í•  ìˆ˜ ìˆë‹¤.

```tsx
const el = document.getElementById("foo"); // elì˜ íƒ€ì…ì€ HTMLElement | null
if (el) {
  el; // el: HTMLElement
} else {
  el; // el: null
}
```

### instanceof

instanceofë¥¼ ì´ìš©í•˜ì—¬ íƒ€ì…ì„ ì¢í ìˆ˜ ìˆë‹¤.

```tsx
function contains(text: string, search: string | RegExp) {
  if (search instanceof RegExp) {
    search; // search: RegExp
    return !!search.exec(text);
  }
  search; // search: string
  return text.includes(search);
}
```

### ì†ì„±ì²´í¬ (in)

ì†ì„±ì²´í¬ë¥¼ ì‚¬ìš©í•´ë„ íƒ€ì…ì„ ì¢í ìˆ˜ ìˆë‹¤.

```tsx
interface A {
  a: number;
}
interface B {
  b: number;
}

function pickAB(ab: A | B) {
  if ("a" in ab) {
    ab; // ab: A
  } else {
    ab; // ab: B
  }
  ab; // ab: A | B
}
```

### isArrayê°™ì€ ë‚´ì¥í•¨ìˆ˜ ì´ìš©í•˜ê¸°

Array.isArrayê°™ì€ ì¼ë¶€ ë‚´ì¥í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ë„ íƒ€ì…ì„ ì¢í ìˆ˜ ìˆë‹¤.

```tsx
function contains(text: string, term: string | string[]) {
  const termList = Array.isArray(term) ? term : [term]; // termList: string[]
  return termList.some((t) => text.includes(t));
}
```

### ëª…ì‹œì  íƒœê·¸ ë¶™ì´ê¸°

íƒœê·¸ëœ ìœ ë‹ˆì˜¨ or êµ¬ë³„ëœ ìœ ë‹ˆì˜¨ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ì´ íŒ¨í„´ì„ ì´ìš©í•˜ì—¬ íƒ€ì…ì„ ì¢í ìˆ˜ ìˆë”°.

```tsx
interface UploadEvent {
  type: "upload";
  filename: string;
}
interface DownloadEvent {
  type: "download";
  filename: string;
}
type AppEvent = UploadEvent | DownloadEvent;

function handleEvent(e: AppEvent) {
  switch (e.type) {
    case "upload":
      console.log(e.filename); // e: UploadEvent
      break;
    case "download":
      console.log(e.filename); // e: DownloadEvent
      break;
  }
}
```

### ì‚¬ìš©ì ì •ì˜ íƒ€ì…ê°€ë“œ (ì»¤ìŠ¤í…€ í•¨ìˆ˜ ë„ì…)

ë§Œì•½ isInputElementì˜ í•¨ìˆ˜ ë°˜í™˜ì´ trueì¸ ê²½ìš°, íƒ€ì…ì²´ì»¤ì—ì„œ ë§¤ê°œë³€ìˆ˜ íƒ€ì…ì„ HTMLInputElementë¡œ ì¢í ìˆ˜ ìˆë‹¤ê³  ì•Œë ¤ì¤€ë‹¤.

```tsx
function isInputElement(element: HTMLElement): element is HTMLInputElement {
  return "value" in element;
}

function getElementContent(el: HTMLElement) {
  if (isInputElement(el)) {
    return el.value; // el: HTMLInputElement
  }
  return el.textContent; // el: HTMLElement
}
```

<aside>
ğŸ’¡

isëŠ” Type Predict êµ¬ë¬¸ì´ë‹¤.

**return ê°’ì´Â `true`ë¼ë©´, type predicateì— ì ì€ ë§ ê·¸ëŒ€ë¡œ 'í•¨ìˆ˜ê°€ í˜¸ì¶œëœ ë²”ìœ„ ë‚´ì—ì„ Â `element`ë¥¼Â `HTMLInputElement`íƒ€ì…ìœ¼ë¡œ ë³´ë¼â€™**

https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates

</aside>

### íƒ€ì…ê°€ë“œ

íƒ€ì…ê°€ë“œë¥¼ ì´ìš©í•˜ë©´ ë°°ì—´ê³¼ ê°ì²´ì˜ íƒ€ì… ì¢íˆê¸°ë¥¼ í•  ìˆ˜ ìˆë‹¤.

```tsx
const jackson5 = ["Jackie", "Tito", "Jermaine", "Marlon", "Michael"];
const members = ["Janet", "Michael"].map((who) =>
  jackson5.find((name) => name === who)
); // result: [undefined, "Michael"], type: (string | undefined)[]
```

ë°°ì—´ì˜ íƒìƒ‰ì—ì„œ undefinedê°€ ë  ìˆ˜ ìˆê¸°ì—, íƒ€ì…ì€ (string | undefined)[]ê°€ ëœë‹¤.

```tsx
const members2 = ["Janet", "Michael"]
  .map((who) => jackson5.find((name) => name === who))
  .filter((who) => who !== undefined);
// result: ["Michael"], type: string[] â“â“â“ëœë‹¤..
```

.filterë¥¼ í†µí•´ undefinedë¥¼ ê±¸ëŸ¬ë‚´ê¸° (ì±…ì—ì„  ì•ˆëœë‹¤ê³ í–ˆëŠ”ë° ë¨..)

```tsx
function isDefined<T>(x: T | undefined): x is T {
  return x !== undefined;
}
const memebers3 = ["Janet", "Michael"]
  .map((who) => jackson5.find((name) => name === who))
  .filter(isDefined); // result: ["Michael"], type: string[]
```

íƒ€ì…ê°€ë“œ (x is T)ë¥¼ ì‚¬ìš©í•˜ë©´ undefined íƒ€ì…ì´ ëª…ì‹œì ìœ¼ë¡œ ê±¸ëŸ¬ì§€ë©´ì„œ íƒ€ì…ì€ string[]ì´ ëœë‹¤.
