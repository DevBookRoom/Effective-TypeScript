## item19. ì¶”ë¡  ê°€ëŠ¥í•œ íƒ€ì…ì„ ì‚¬ìš©í•´ ì¥í™©í•œ ì½”ë“œ ë°©ì§€í•˜ê¸°

### TSê°€ ì¶”ë¡  ê°€ëŠ¥í•œ ê²½ìš°ë“¤

íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ê°€ ì¶”ë¡  ê°€ëŠ¥í•œ íƒ€ì…ë“¤ì€ íƒ€ì…êµ¬ë¬¸ì´ ì‚¬ì‹¤ ë¶ˆí•„ìš”í•˜ë‹¤.

```tsx
let x = 12; // x:numberë¡œ ì´ë¯¸ ì¶”ë¡ ë˜ì–´ìˆìŒ

const person = {
  name: "í™ê¸¸ë™", // name: string
  born: {
    where: "ì„œìš¸", // where: string
    when: "2023-01-01", // when: string
  },
};
```

í•¨ìˆ˜ì˜ ë¦¬í„´íƒ€ì…ì´ ëª…í™•í•œ ê²½ìš°ì—ë„, íƒ€ì…ì¶”ë¡ ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ë”°ë¡œ ëª…ì‹œí•  í•„ìš”ê°€ ì—†ë‹¤.

```tsx
function square(nums: number[]) {
  return nums.map((num) => num * num);
}

const squareNumbers = square([1, 2, 3, 4, 5]); // squareNumbers: number[]ë¡œ ì´ë¯¸ ì¶”ë¡ 
```

ë§¤ê°œë³€ìˆ˜ì— ê¸°ë³¸ê°’ì´ ìˆëŠ” ê²½ìš°ë„ íƒ€ì…êµ¬ë¬¸ ìƒëµ ê°€ëŠ¥

```tsx
function parseNumber(str: string, base = 10) {
  // base: numberë¡œ ìë™ ì¶”ë¡ 
  return parseInt(str, base);
}
```

íƒ€ì…ì •ë³´ê°€ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, ì½œë°±í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜íƒ€ì…ì€ ìë™ìœ¼ë¡œ ì¶”ë¡ ëœë‹¤.

```tsx
// âŒ express HTTP ì„œë²„ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ í•´ë‹¹ íƒ€ì…ì„ ì–¸ì€ ë¶ˆí•„ìš”í•¨
app.get("/health", (req: express.Request, res: express.Response) => {
  res.send("ok");
});

// âœ… íƒ€ì…ì„ ì–¸ ì—†ì–´ë„ ì¶”ë¡  ê°€ëŠ¥í•˜ë‹¤
app.get("/health", (req, res) => {
  res.send("ok");
});
```

### ë¹„êµ¬ì¡°í™” í• ë‹¹ë¬¸ í™œìš©

íƒ€ì…ì´ ì¶”ë¡ ë˜ë©´ íƒ€ì…ì„ ëª…ì‹œí•˜ì§€ ì•ŠëŠ”ê²ƒì´ ë¦¬íŒ©í† ë§ë„ ë” ì‰¬ì›Œì§„ë‹¤.

```tsx
interface Product {
  id: number;
  name: string;
  price: number;
}
```

íƒ€ì… ëª…ì‹œí•œ ì¼€ì´ìŠ¤

```tsx
function logProduct(product: Product) {
  const id: number = product.id;
  const name: string = product.name;
  const price: number = product.price;
  console.log(`${id} ${name}ì˜ ê°€ê²©ì€ ${price}ì›ì…ë‹ˆë‹¤.`);
}
```

- idê°€ stringìœ¼ë¡œ ë°”ë€” ê²½ìš°, logProduct í•¨ìˆ˜ ë‚´ì˜ íƒ€ì…ê¹Œì§€ ìˆ˜ì • í•„ìš”

ë¹„êµ¬ì¡°í™” í• ë‹¹ë¬¸

```tsx
function logProduct2(product: Product) {
  const { id, name, price } = product;
  console.log(`${id} ${name}ì˜ ê°€ê²©ì€ ${price}ì›ì…ë‹ˆë‹¤.`);
}
```

- ë¹„êµ¬ì¡°í™” í• ë‹¹ë¬¸ì€ ë³€ìˆ˜ì˜ íƒ€ì…ì´ ì¶”ë¡ ë˜ë„ë¡ í•¨
- ë§¤ê°œë³€ìˆ˜ì˜ íƒ€ì… Productë§Œ ì§€ì •í•˜ëŠ”ê²ƒìœ¼ë¡œ ì¶©ë¶„í•˜ë‹¤!
- idê°€ stringìœ¼ë¡œ ë°”ë€Œì–´ë„ í•´ë‹¹ í•¨ìˆ˜ëŠ” ìˆ˜ì •ë  í•„ìš”âŒ, ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ì›Œì§„ë‹¤

### íƒ€ì… ëª…ì‹œí•˜ëŠ”ê²Œ ì¢‹ì€ ì¼€ì´ìŠ¤

ê°ì²´ ë¦¬í„°ëŸ´ ì •ì˜í•  ë• íƒ€ì…ì„ ëª…ì‹œí•˜ëŠ”ê²Œ ì¢‹ë‹¤. ë§Œì•½ ê°ì²´ë¦¬í„°ëŸ´ì„ ì„ ì–¸í•  ë•Œ íƒ€ì…êµ¬ë¬¸ì„ ì œê±°í•œë‹¤ë©´, ê°ì²´ë¥¼ ì„ ì–¸í•œ ê³³ì´ ì•„ë‹ˆë¼ ì‚¬ìš©ë˜ëŠ” ê³³ì—ì„œ íƒ€ì…ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

```tsx
interface Product {
  id: string;
  name: string;
  price: number;
}

// ê°ì²´ ë¦¬í„°ëŸ´ì— íƒ€ì…êµ¬ë¬¸X
const furby = {
  id: 200222, // idë¥¼ stringì´ ì•„ë‹Œ numberë¡œ ì„ ì–¸! - ë¦¬í„°ëŸ´ì— íƒ€ì…ì„ ëª…ì‹œí–ˆë‹¤ë©´, í•´ë‹¹ ì„ ì–¸ë¶€ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤
  name: "Furby",
  price: 20000,
};
logProduct(furby); // âŒ ì„ ì–¸ë¶€ê°€ ì•„ë‹ˆë¼ ì‹¤ì œ ì‚¬ìš©í•˜ëŠ” ê³³ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤! - ë””ë²„ê¹… ì–´ë ¤ì›€
```

í•¨ìˆ˜ ë°˜í™˜íƒ€ì… ëª…ì‹œí•˜ë©´ ì˜¤ë¥˜ë¥¼ ì‚¬ì „ì— ë°œê²¬í•˜ì—¬ ì—ëŸ¬ë°©ì§€í•  ìˆ˜ ìˆë‹¤.

ì¡°ê±´ì— ë”°ë¼ ë¦¬í„´íƒ€ì…ì´ ë‹¤ë¥´ê²Œ ë‚˜ì˜¤ì§€ë§Œ, return typeì„ ëª…ì‹œí•˜ì§€ ì•Šì•„ tsëŠ” ì—ëŸ¬ë¥¼ ì¡ì•„ì£¼ì§€ ì•ŠëŠ”ë‹¤.

```tsx
const cache: { [ticker: string]: number } = {};
function getQuote(ticker: string) {
  if (cache[ticker]) {
    // â“â“â“ return number
    return cache[ticker];
  }
  // â“â“â“ return Promise<number>
  return fetch("https://api.example.com/quote?ticker=" + ticker)
    .then((response) => response.json())
    .then((data) => {
      cache[ticker] = data;
      return data;
    });
}
```

ë¦¬í„´íƒ€ì…ì„ ëª…ì‹œí•˜ë©´ í•´ë‹¹ ì˜¤ë¥˜ë¥¼ ë¯¸ë¦¬ ë°œê²¬í•  ìˆ˜ ìˆë‹¤!

```tsx
const cache: { [ticker: string]: number } = {};
function getQuote(ticker: string): Promise<number> {
  if (cache[ticker]) {
    // return cache[ticker]; // âŒ ì˜¤ë¥˜ë°œìƒ!! - Type 'number' is not assignable to type 'Promise<number>'.
    return Promise.resolve(cache[ticker]); // âœ… í•´ê²°ë°©ë²• - Promise.resolveë¥¼ ì‚¬ìš©í•˜ì—¬ ì¦‰ì‹œ í•´ê²°
  }
  return fetch("https://api.example.com/quote?ticker=" + ticker)
    .then((response) => response.json())
    .then((data) => {
      cache[ticker] = data;
      return data;
    });
}
```

---

## item20. ë‹¤ë¥¸ íƒ€ì…ì—ëŠ” ë‹¤ë¥¸ ë³€ìˆ˜ ì‚¬ìš©í•˜ê¸°

```tsx
// âŒ Don't
let id = "12-34-56";
fetchProduct(id);
id = 123456;
fetchProductBySerialNumber(id);
```

```tsx
// âœ… Do
const id = "123456"; // string
fetchProduct(id);
const serial = 123456; // number
fetchProductBySerialNumber(serial);
```

- ì„œë¡œ ê´€ë ¨ì—†ëŠ” ê°’ì€ ë¶„ë¦¬í•œë‹¤ (id, serial)
- ë³€ìˆ˜ëª…ì€ êµ¬ì²´ì ìœ¼ë¡œ ì§“ëŠ”ë‹¤
- íƒ€ì…ì¶”ë¡ ì„ í–¥ìƒì‹œí‚¤ë©´ íƒ€ì…êµ¬ë¬¸ì´ ë¶ˆí•„ìš”í•´ì§€ê³ , íƒ€ì…ì´ ë” ê°„ê²°í•´ì§„ë‹¤
- let ëŒ€ì‹  constë¡œ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ê²Œ ë˜ê³ , ì´ëŠ” íƒ€ì…ì²´ì»¤ê°€ íƒ€ì…ì„ ì¶”ë¡ í•˜ê¸° ì¢‹ë‹¤

---

## item21. íƒ€ì… ë„“íˆê¸°

### íƒ€ì… ë„“íˆê¸°ë€?

ìƒìˆ˜ë¥¼ ì´ìš©í•´ì„œ ë³€ìˆ˜ë¥¼ ì´ˆê¸°í™”í•  ë•Œ íƒ€ì…ì„ ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ íƒ€ì…ì²´ì»¤ëŠ” íƒ€ì…ì„ ê²°ì •í•´ì•¼ í•œë‹¤.

ì¦‰, ì§€ì •ëœ ë‹¨ì¼ê°’ì„ ê°€ì§€ê³  í• ë‹¹ ê°€ëŠ¥í•œ ê°’ë“¤ì˜ ì§‘í•©ì„ ìœ ì¶”í•´ì•¼í•œë‹¤. == TSì˜ ë„“íˆê¸° ê³¼ì • (widening)

```tsx
interface Vector3 {
  x: number;
  y: number;
  z: number;
}
function getComponent(vector: Vector3, axis: "x" | "y" | "z") {
  return vector[axis];
}

let x = "x"; // ë„“íˆê¸° ì‹œì ì— stringìœ¼ë¡œ ì¶”ë¡ ë¨
let vec = { x: 1, y: 2, z: 3 };
getComponent(vec, x); // âŒ ì˜¤ë¥˜ë°œìƒ! - Argument of type 'string' is not assignable to parameter of type '"x" | "y" | "z"'
```

xëŠ” í• ë‹¹ ì‹œì ì— ë„“íˆê¸° ê³¼ì •ì„ í†µí•´ stringìœ¼ë¡œ ì¶”ë¡ ë˜ì§€ë§Œ, getComponentì˜ axis "x" | "y" | "z"íƒ€ì…ì— í• ë‹¹ì´ ë¶ˆê°€ëŠ¥í•˜ì—¬ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

### íƒ€ì… ë„“íˆê¸° ì œì–´í•˜ê¸°

constë¥¼ ì´ìš©í•˜ë©´ ë„“íˆê¸° ê³¼ì •ì„ ì œì–´í•  ìˆ˜ ìˆë‹¤.

let ëŒ€ì‹  constë¡œ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ë©´, í•´ë‹¹ ë³€ìˆ˜ëŠ” ì¬í• ë‹¹ ë  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ë” ì¢ì€ íƒ€ì…ì´ ëœë‹¤.

```tsx
const x = "x"; // âœ¨ constë¡œ ì„ ì–¸í•˜ì—¬ stringì´ ì•„ë‹ˆë¼ "x"íƒ€ì…ìœ¼ë¡œ í• ë‹¹ë¨
let vec = { x: 1, y: 2, z: 3 };
getComponent(vec, x); // âœ… ì˜¤ë¥˜ ì—†ìŒ
```

ê°ì²´ì™€ ë°°ì—´ì˜ ê²½ìš°ì—” constë¡œë„ ì œì–´ê°€ ë˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆë‹¤.

TSë„“íˆê¸° ì•Œê³ ë¦¬ì¦˜ì€ ê°ì²´ì˜ ê° ìš”ì†Œë¥¼ letìœ¼ë¡œ í• ë‹¹ëœ ê²ƒì²˜ëŸ¼ ë‹¤ë£¬ë‹¤.

```tsx
const v = { x: 1 }; // xëŠ” letì²˜ëŸ¼ ë‹¤ë£¨ì–´ì§ => x: number

v.x = 2; // âœ… ì˜¤ë¥˜ ì—†ìŒ - xëŠ” numberíƒ€ì…ì´ë¯€ë¡œ í• ë‹¹ ê°€ëŠ¥
v.x = "x"; // âŒ ì˜¤ë¥˜ë°œìƒ! - Type 'string' is not assignable to type 'number'.
v.y = 4; // âŒ ì˜¤ë¥˜ë°œìƒ! - Property 'y' does not exist on type '{ x: number; }'.
v.name = "rachel"; // âŒ ì˜¤ë¥˜ë°œìƒ! - Property 'name' does not exist on type '{ x: number; }'.
```

ê°ì²´/ë°°ì—´ì˜ íƒ€ì…ì¶”ë¡ ì˜ ê°•ë„ë¥¼ ì§ì ‘ ì œì–´í•˜ëŠ” ë°©ë²•ì€

1. ëª…ì‹œì  íƒ€ì…êµ¬ë¬¸ì„ ì œê³µí•˜ê¸°

   ```tsx
   const v: { x: 1 | 3 | 5 } = {
     x: 1,
   }; // vì˜ íƒ€ì…ì€ { x: 1|3|5}
   ```

2. íƒ€ì…ì²´ì»¤ì— ì¶”ê°€ì ì¸ ë¬¸ë§¥ì„ ì œê³µí•˜ê¸° (í•¨ìˆ˜ì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ê°’ ì „ë‹¬ ë“±) â†’ item26 íƒ€ì…ì¶”ë¡ ê³¼ì •ì—ì„œ ìì„¸íˆ ë‹¤ë£¸
3. const ë‹¨ì–¸ë¬¸ ì‚¬ìš©í•˜ê¸°

   ```tsx
   const v1 = {
     x: 1,
     y: 2,
   }; // v1ì˜ íƒ€ì…ì€ { x: number, y: number }

   const v2 = {
     x: 1 as const,
     y: 2,
   }; // v2ì˜ íƒ€ì…ì€ { x: 1, y: number }

   const v3 = {
     x: 1,
     y: 2,
   } as const; // v3ì˜ íƒ€ì…ì€ { readonly x: 1, readonly y: 2 }
   ```

   ```
   const a1 = [1, 2, 3]; // a1ì˜ íƒ€ì…ì€ (number)[]
   const a2 = [1, 2, 3] as const; // a2ì˜ íƒ€ì…ì€ readonly [1, 2, 3]
   ```

   ê°’ ë’¤ì— as constë¥¼ ì‘ì„±í•˜ë©´, TSëŠ” ìµœëŒ€í•œ ì¢ì€ íƒ€ì…ìœ¼ë¡œ ì¶”ë¡ í•œë‹¤. as constë¥¼ ì‚¬ìš©í•˜ì—¬ ë„“íˆê¸°ë¡œ ì¸í•œ ì˜¤ë¥˜ë¥¼ ì¤„ì¼ ìˆ˜ ìˆë‹¤.

---

## item22. íƒ€ì… ì¢íˆê¸°

íƒ€ì… ì¢íˆê¸°ëŠ” TSê°€ ë„“ì€ íƒ€ì…ìœ¼ë¡œë¶€í„° ì¢ì€ íƒ€ì…ìœ¼ë¡œ ì§„í–‰í•˜ëŠ” ê³¼ì •ì„ ë§í•œë‹¤.

### nullì²´í¬

nullì²´í¬ëŠ” ëŒ€í‘œì ì¸ íƒ€ì…ì¢íˆê¸°ì˜ ì˜ˆì‹œì´ë‹¤. ë¶„ê¸°ì— ë”°ë¼ ë³€ìˆ˜ì˜ íƒ€ì…ì„ ì¢í˜€ ì¶”ë¡ í•  ìˆ˜ ìˆë‹¤.

```tsx
const el = document.getElementById("foo"); // elì˜ íƒ€ì…ì€ HTMLElement | null
if (el) {
  el; // el: HTMLElement
} else {
  el; // el: null
}
```

### instanceof

instanceofë¥¼ ì´ìš©í•˜ì—¬ íƒ€ì…ì„ ì¢í ìˆ˜ ìˆë‹¤.

```tsx
function contains(text: string, search: string | RegExp) {
  if (search instanceof RegExp) {
    search; // search: RegExp
    return !!search.exec(text);
  }
  search; // search: string
  return text.includes(search);
}
```

### ì†ì„±ì²´í¬ (in)

ì†ì„±ì²´í¬ë¥¼ ì‚¬ìš©í•´ë„ íƒ€ì…ì„ ì¢í ìˆ˜ ìˆë‹¤.

```tsx
interface A {
  a: number;
}
interface B {
  b: number;
}

function pickAB(ab: A | B) {
  if ("a" in ab) {
    ab; // ab: A
  } else {
    ab; // ab: B
  }
  ab; // ab: A | B
}
```

### isArrayê°™ì€ ë‚´ì¥í•¨ìˆ˜ ì´ìš©í•˜ê¸°

Array.isArrayê°™ì€ ì¼ë¶€ ë‚´ì¥í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ë„ íƒ€ì…ì„ ì¢í ìˆ˜ ìˆë‹¤.

```tsx
function contains(text: string, term: string | string[]) {
  const termList = Array.isArray(term) ? term : [term]; // termList: string[]
  return termList.some((t) => text.includes(t));
}
```

### ëª…ì‹œì  íƒœê·¸ ë¶™ì´ê¸°

íƒœê·¸ëœ ìœ ë‹ˆì˜¨ or êµ¬ë³„ëœ ìœ ë‹ˆì˜¨ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ì´ íŒ¨í„´ì„ ì´ìš©í•˜ì—¬ íƒ€ì…ì„ ì¢í ìˆ˜ ìˆë‹¤.

```tsx
interface UploadEvent {
  type: "upload";
  filename: string;
}
interface DownloadEvent {
  type: "download";
  filename: string;
}
type AppEvent = UploadEvent | DownloadEvent;

function handleEvent(e: AppEvent) {
  switch (e.type) {
    case "upload":
      console.log(e.filename); // e: UploadEvent
      break;
    case "download":
      console.log(e.filename); // e: DownloadEvent
      break;
  }
}
```

### ì‚¬ìš©ì ì •ì˜ íƒ€ì…ê°€ë“œ (ì»¤ìŠ¤í…€ í•¨ìˆ˜ ë„ì…)

ë§Œì•½ isInputElementì˜ í•¨ìˆ˜ ë°˜í™˜ì´ trueì¸ ê²½ìš°, íƒ€ì…ì²´ì»¤ì—ì„œ ë§¤ê°œë³€ìˆ˜ íƒ€ì…ì„ HTMLInputElementë¡œ ì¢í ìˆ˜ ìˆë‹¤ê³  ì•Œë ¤ì¤€ë‹¤.

```tsx
function isInputElement(element: HTMLElement): element is HTMLInputElement {
  return "value" in element;
}

function getElementContent(el: HTMLElement) {
  if (isInputElement(el)) {
    return el.value; // el: HTMLInputElement
  }
  return el.textContent; // el: HTMLElement
}
```

<aside>
ğŸ’¡

isëŠ” Type Predict êµ¬ë¬¸ì´ë‹¤.

**return ê°’ì´Â `true`ë¼ë©´, type predicateì— ì ì€ ë§ ê·¸ëŒ€ë¡œ 'í•¨ìˆ˜ê°€ í˜¸ì¶œëœ ë²”ìœ„ ë‚´ì—ì„ Â `element`ë¥¼Â `HTMLInputElement`íƒ€ì…ìœ¼ë¡œ ë³´ë¼â€™**

https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates

</aside>

### íƒ€ì…ê°€ë“œ

íƒ€ì…ê°€ë“œë¥¼ ì´ìš©í•˜ë©´ ë°°ì—´ê³¼ ê°ì²´ì˜ íƒ€ì… ì¢íˆê¸°ë¥¼ í•  ìˆ˜ ìˆë‹¤.

```tsx
const jackson5 = ["Jackie", "Tito", "Jermaine", "Marlon", "Michael"];
const members = ["Janet", "Michael"].map((who) =>
  jackson5.find((name) => name === who)
); // result: [undefined, "Michael"], type: (string | undefined)[]
```

ë°°ì—´ì˜ íƒìƒ‰ì—ì„œ undefinedê°€ ë  ìˆ˜ ìˆê¸°ì—, íƒ€ì…ì€ (string | undefined)[]ê°€ ëœë‹¤.

```tsx
const members2 = ["Janet", "Michael"]
  .map((who) => jackson5.find((name) => name === who))
  .filter((who) => who !== undefined);
// result: ["Michael"], type: string[] â“â“â“ëœë‹¤..
```

.filterë¥¼ í†µí•´ undefinedë¥¼ ê±¸ëŸ¬ë‚´ì–´ íƒ€ì…ì€ string[] (ì±…ì—ì„  ì•ˆëœë‹¤ê³ í–ˆëŠ”ë° ë¨..)

```tsx
function isDefined<T>(x: T | undefined): x is T {
  return x !== undefined;
}
const memebers3 = ["Janet", "Michael"]
  .map((who) => jackson5.find((name) => name === who))
  .filter(isDefined); // result: ["Michael"], type: string[]
```

íƒ€ì…ê°€ë“œ (x is T)ë¥¼ ì‚¬ìš©í•˜ë©´ undefined íƒ€ì…ì´ ëª…ì‹œì ìœ¼ë¡œ ê±¸ëŸ¬ì§€ë©´ì„œ íƒ€ì…ì€ string[]ì´ ëœë‹¤.

---

## item23. í•œêº¼ë²ˆì— ê°ì²´ ìƒì„±í•˜ê¸°

### ê°ì²´ì˜ ì—¬ëŸ¬ ì†ì„±ì„ í•œêº¼ë²ˆì— ìƒì„±í•˜ì

ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì†ì„±ì„ í•˜ë‚˜ì”© ìƒì„±í•˜ê¸°ë³´ë‹¤ëŠ”, ì—¬ëŸ¬ ì†ì„±ì„ í•œêº¼ë²ˆì— ìƒì„±í•´ì•¼ íƒ€ì… ì¶”ë¡ ì— ìœ ë¦¬í•˜ë‹¤.

```tsx
// ğŸ‘ ê°ì²´ ì†ì„±ì„ í•˜ë‚˜ì”© ìƒì„±
const pt = {};
pt.x = 1; // âŒ ì˜¤ë¥˜ë°œìƒ! - Property 'x' does not exist on type '{}'.
pt.y = 2; // âŒ ì˜¤ë¥˜ë°œìƒ! - Property 'y' does not exist on type '{}'.

// ğŸ‘ ì—¬ëŸ¬ ì†ì„±ì„ í•œêº¼ë²ˆì— ìƒì„±
const pt2 = { x: 3, y: 4 }; // âœ… pt2ì˜ íƒ€ì…ì€ { x: number, y: number }ë¡œ ì¶”ë¡ ë¨
```

ìœ„ì˜ ptíƒ€ì…ì€ {} ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¶”ë¡ ë˜ë¯€ë¡œ xì™€ yë¥¼ ì¶”ê°€í•˜ë ¤í•  ë•Œ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ë§Œ, pt2ì²˜ëŸ¼ ê°ì²´ë¥¼ í•œêº¼ë²ˆì— ì •ì˜í•˜ë©´ íƒ€ì…ì´ ì •ìƒì ìœ¼ë¡œ ì¶”ë¡ ëœë‹¤.

```tsx
interface Point {
  x: number;
  y: number;
}

// ğŸ‘ íƒ€ì… ë‹¨ì–¸ë¬¸ (as) ì‚¬ìš©
const pt3 = {} as Point;
pt3.x = 1; // âœ… ì˜¤ë¥˜ ì—†ìŒ
pt3.y = 2; // âœ… ì˜¤ë¥˜ ì—†ìŒ

// ğŸ‘ ê°ì²´ í•œêº¼ë²ˆì— ë§Œë“¤ê¸°
const pt4: Point = { x: 1, y: 2 };
```

interfaceë¥¼ í™œìš©í•˜ëŠ” ê²½ìš°ì—ë„ íƒ€ì…ë‹¨ì–¸ë¬¸ asë¥¼ í™œìš©í•˜ë©´ ì¶”í›„ì— ì†ì„±ì„ í•˜ë‚˜ì”© ì¶”ê°€í•˜ì—¬ë„ íƒ€ì…ì²´ì»¤ë¥¼ í”¼í•´ê°ˆ ìˆ˜ ìˆì§€ë§Œ, ê·¸ë˜ë„ í•œêº¼ë²ˆì— ë§Œë“œëŠ”ê²Œ ë” ë‚«ë‹¤.

### ê°ì²´ ì „ê°œì—°ì‚°ì ì´ìš©í•˜ê¸°

ì‘ì€ ê°ì²´ë“¤ì„ ì¡°í•©í•´ì„œ í° ê°ì²´ë¥¼ ë§Œë“¤ì–´ì•¼í•˜ëŠ” ê²½ìš°ì—” ê°ì²´ì „ê°œì—°ì‚°ì(â€¦)ì„ í™œìš©í•˜ëŠ”ê²Œ ì¢‹ë‹¤.

```tsx
const pt = { x: 1, y: 2 };
const id = { name: "point1" };

// ğŸ‘ namedPoint íƒ€ì…ì€ {}ë¡œ ì¶”ë¡ ë˜ì–´ ì—ëŸ¬ ë°œìƒ
const namedPoint = {};
Object.assign(namedPoint, pt, id);
namedPoint.name = "point1"; // âŒ ì˜¤ë¥˜ë°œìƒ! - Property 'name' does not exist on type '{}'.

// ğŸ‘ ê°ì²´ ì „ê°œ ì—°ì‚°ìë¡œ í•œë²ˆì— í• ë‹¹ - íƒ€ì… ì¶”ë¡  ê°€ëŠ¥
const namedPoint2 = { ...pt, ...id }; // âœ… namedPoint2ì˜ íƒ€ì…ì€ { x: number, y: number, name: string }ë¡œ ì¶”ë¡ ë¨
```

### ì¡°ê±´ë¶€ ì†ì„± ì¶”ê°€í•˜ê¸°

íƒ€ì…ì— ì•ˆì „í•œ ë°©ì‹ìœ¼ë¡œ ì¡°ê±´ë¶€ ì†ì„±ì„ ì¶”ê°€í•˜ê¸° ìœ„í•´ì„  ì†ì„±ì„ ì¶”ê°€í•˜ì§€ ì•ŠëŠ” null ë˜ëŠ” {}ë¡œ ê°ì²´ ì „ê°œë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

```tsx
declare let hasMiddle: boolean;
const firstLast = { first: "Abraham", last: "Lincoln" };
const president = { ...firstLast, ...(hasMiddle ? { middle: "Middle" } : {}) }; // âœ… middleíƒ€ì…ì´ ì¡°ê±´ë¶€ ì†ì„±ìœ¼ë¡œ ì¶”ê°€ë¨! - { first: string, last: string, middle?: string }
```

ì „ê°œ ì—°ì‚°ìë¡œ í•œêº¼ë²ˆì— ì—¬ëŸ¬ê°œì˜ ì†ì„±ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.

```tsx
declare let hasDates: boolean;
const nameTitle = { name: "Sejong", title: "King" };
const king = {
  ...nameTitle,
  ...(hasDates ? { start: "1418", end: "1450" } : {}),
};
```

- ì‹¤ì œ Output

```tsx
// ì¶”ë¡ ëœ king type - â“ì±…ê³¼ ë‹¤ë¦„
const king: {
  start?: string | undefined;
  end?: string | undefined;
  name: string;
  title: string;
};
```

- ì±… version - startì™€ endê°€ í•­ìƒ í•¨ê»˜ ì •ì˜ë˜ê¸° ë•Œë¬¸ì—, ìœ ë‹ˆì˜¨ìœ¼ë¡œ í‘œí˜„í•˜ëŠ”ê²Œ ê°€ëŠ¥í•œ ê°’ì˜ ì§‘í•©ì„ ë” ì •í™•íˆ í‘œí˜„í•œë‹¤

```tsx
const king:
  | {
      start: string;
      end: string;
      name: string;
      title: string;
    }
  | {
      name: string;
      title: string;
    };
```

í•¼í¼í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ë©´ ì„ íƒì  í•„ë“œë¥¼ ë” ëª…ì‹œì ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤.

```tsx
// Helper í•¨ìˆ˜
function addOptional<T extends object, U extends object>(
  a: T,
  b: U | null
): T & Partial<U> {
  return { ...a, ...b };
}

const king2 = addOptional(
  nameTitle,
  hasDates ? { start: "1418", end: "1450" } : null
);

king2.start; // string | undefined
```

---

## item24. ì¼ê´€ì„± ìˆëŠ” ë³„ì¹­ ì‚¬ìš©í•˜ê¸°

### ë³„ì¹­ì„ ì¼ê´€ì„±ìˆê²Œ ì‚¬ìš©í•˜ì§€ ì•Šì„ ê²½ìš°

```tsx
const borough = { name: "Brooklyn", location: [40.692, -73.945] };
const loc = borough.location;

loc[0] = 0;
borough.location; // [0, -73.945]  - â—ï¸ ì›ë˜ì˜ borough.location ë°°ì—´ë„ ë³€ê²½ë¨
```

ë§Œì•½ ê°ì²´ì˜ ì–´ë–¤ ë°°ì—´ì— ë³„ì¹­ì„ ë§Œë“¤ê³ , ê·¸ ë³„ì¹­ì˜ ê°’ì„ ë³€ê²½í•˜ë©´ ì›ë˜ì˜ ì†ì„±ê°’ì—ì„œë„ ë³€ê²½ëœë‹¤. ì´ë ‡ê²Œ ë³„ì¹­ì„ ë‚¨ë°œí•˜ì—¬ ì‚¬ìš©í•˜ë©´ ì œì–´íë¦„ì„ ë¶„ì„í•˜ê¸° ì–´ë µë‹¤.

```tsx
interface Coordinate {
  x: number;
  y: number;
}
interface BoundingBox {
  x: [number, number];
  y: [number, number];
}

interface Polygon {
  exterior: Coordinate[];
  holes: Coordinate[][];
  bbox?: BoundingBox;
}
```

- ë³„ì¹­ì„ ì‚¬ìš©í•˜ì§€ ì•Šì€ case

  ```tsx
  // ì–´ë–¤ ì ì´ ë‹¤ê°í˜• ë‚´ë¶€ì— ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
  function isPointInPolygon(point: Coordinate, polygon: Polygon): boolean {
    if (polygon.bbox) {
      if (
        point.x < polygon.bbox.x[0] ||
        point.x > polygon.bbox.x[1] ||
        point.y < polygon.bbox.y[0] ||
        point.y > polygon.bbox.y[1]
      ) {
        return false;
      } else {
        return true;
      }
    }
  }
  ```

- ë³„ì¹­ì„ ì¼ê´€ì„± ì—†ì´ ì‚¬ìš©í•œ case

```tsx
function isPointInPolygon2(point: Coordinate, polygon: Polygon) {
  const box = polygon.bbox; // bboxì˜ ë³„ì¹­ ìƒì„± (BoundingBox | undefined)

  polygon.bbox; // íƒ€ì…ì´ BoundingBox | undefined
  box; // íƒ€ì…ì´ BoundingBox | undefined

  if (polygon.bbox) {
    // âŒ - ì¼ê´€ì„± ì—†ëŠ” ë³„ì¹­ ì‚¬ìš©
    polygon.bbox; // íƒ€ì…ì´ BoundingBox
    box; // íƒ€ì…ì´ BoundingBox | undefined - â—ï¸ë³„ì¹­ì´ íë¦„ ë¶„ì„ì„ ë°©í•´í•¨

    if (
      point.x < box.x[0] ||
      point.x > box.x[1] ||
      point.y < box.y[0] ||
      point.y > box.y[1]
    ) {
      return false;
    } else {
      return true;
    }
  }
}
```

- ì†ì„±ì²´í¬ëŠ” polygon.bboxì˜ íƒ€ì…ì„ ì •ì œí–ˆì§€ë§Œ, boxì˜ íƒ€ì…ì€ ì •ì œí•˜ì§€ ëª»í•¨ â†’ ì˜¤ë¥˜ ë°œìƒ!
- ifë¬¸ì„ boxë¡œ ë°”ê¾¼ë‹¤ë©´ ì œëŒ€ë¡œ ë™ì‘í•¨

- ë³„ì¹­ì„ ì¼ê´€ì„± ìˆê²Œ ì‚¬ìš©í•œ case

```tsx
function isPointInPolygon2(point: Coordinate, polygon: Polygon) {
  const box = polygon.bbox; // bboxì˜ ë³„ì¹­ ìƒì„± (BoundingBox | undefined)

  polygon.bbox; // íƒ€ì…ì´ BoundingBox | undefined
  box; // íƒ€ì…ì´ BoundingBox | undefined

  if (box) {
    // âœ… ì¼ê´€ì„± ìˆëŠ” ë³„ì¹­ ì‚¬ìš©
    polygon.bbox; // íƒ€ì…ì´ BoundingBox | undefined
    box; // íƒ€ì…ì´ BoundingBox

    if (
      point.x < box.x[0] ||
      point.x > box.x[1] ||
      point.y < box.y[0] ||
      point.y > box.y[1]
    ) {
      return false;
    } else {
      return true;
    }
  }
}
```

- ì†ì„±ì²´í¬ì™€ ë‚´ë¶€ ì‚¬ìš© ë³€ìˆ˜ë¥¼ ì¼ê´€ì„± ìˆê²Œ ìœ ì§€ â†’ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠìŒ

### ê°ì²´ ë¹„êµ¬ì¡°í™” ì‚¬ìš©í•˜ê¸°

ê°ì²´ ë¹„êµ¬ì¡°í™”ë¥¼ ì‚¬ìš©í•˜ë©´ ì¼ê´€ëœ ì´ë¦„ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```tsx
function isPointInPolygon3(point: Coordinate, polygon: Polygon) {
  const { bbox } = polygon; // ì¼ê´€ëœ ì´ë¦„ ì‚¬ìš© ê°€ëŠ¥

  if (bbox) {
    const { x, y } = point;
    if (x < bbox.x[0] || x > bbox.x[1] || y < bbox.y[0] || y > bbox.y[1]) {
      return false;
    } else {
      return true;
    }
  }
}
```

### ê°ì²´ ë¹„êµ¬ì¡°í™” ì‚¬ìš©ì‹œ ì£¼ì˜ì 

```tsx
function isPointInPolygon4(point: Coordinate, polygon: Polygon) {
  const { bbox } = polygon;
  if (!bbox) {
    polygon.bbox; // BoundingBox | undefined
    bbox; // undefined

    calculatePolygonBbox(polygon); // polygonì˜ bboxê°€ ì±„ì›Œì§
    // polygon.bboxì™€ bboxëŠ” ë‹¤ë¥¸ ê°’ì„ ì°¸ì¡°í•˜ê²Œë¨!
  }
}
```

ë³„ì¹­ ì‚¬ìš©ì€ ë‹¤ìŒê³¼ ê°™ì´ ëŸ°íƒ€ì„ì—ë„ ë¬¸ì œë¥¼ ì•¼ê¸°í•  ìˆ˜ ìˆë‹¤. ëŸ°íƒ€ì„ ì¤‘ polygon.bboxì˜ ê°’ì´ ë³€ê²½ëœë‹¤ë©´, bboxì™€ polygon.bboxëŠ” ë‹¤ë¥¸ ê°’ì„ ê°€ì§€ê²Œë  ìˆ˜ ìˆë‹¤.

```tsx
function fn2(polygon: Polygon) {
  polygon.bbox; // BoundingBox | undefined

  if (polygon.bbox) {
    polygon.bbox; // BoundingBox
    fn(polygon); // â—ï¸ ì–´ë–¤ í•¨ìˆ˜ê°€ polygon.bboxë¥¼ ì œê±°í•  ìˆ˜ ìˆìŒ
    polygon.bbox; // â—ï¸ íƒ€ì…ì´ ì—¬ì „íˆ BoundingBox (undefinedê°€ ì œì™¸ë¨)
  }
}
```

ì–´ë– í•œ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´, í•´ë‹¹ í•¨ìˆ˜ê°€ ì†ì„±ê°’ì„ ë³€ê²½ì‹œì¼œë²„ë¦´ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ TSëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ì†ì„±ì²´í¬ë¥¼ ë°˜ë³µí•˜ì§€ ì•ŠëŠ”ë‹¤.

ìœ„ì˜ ê²½ìš°ëŠ” polygon.bboxë¡œ ì†ì„±ì„ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹ ì—, bboxë¼ëŠ” ì§€ì—­ë³€ìˆ˜ë¡œ ë½‘ì•„ë‚´ì–´ ì‚¬ìš©í•˜ë©´ bboxëŠ” ì •í™•íˆ ìœ ì§€ëœë‹¤. (í•˜ì§€ë§Œ polygon.bboxì˜ ê°’ê³¼ëŠ” ê°™ê²Œ ìœ ì§€ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ)

---

## item25. ë¹„ë™ê¸° ì½”ë“œì—ëŠ” ì½œë°± ëŒ€ì‹  async í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°

### ì½œë°±ë³´ë‹¨ Promise

ì½œë°±ë³´ë‹¤ëŠ” í”„ë¡œë¯¸ìŠ¤ë‚˜ async/awaitì„ ì‚¬ìš©í•´ì•¼í•œë‹¤.

```tsx
async function fetchPages() {
  const [res1, res2, res3] = await Promise.all([
    // ì„¸ê°€ì§€ response ë³€ìˆ˜ ê°ê°ì˜ íƒ€ì…ì„ Responseë¡œ ì¶”ë¡ 
    fetch("https://example.com/page1"),
    fetch("https://example.com/page2"),
    fetch("https://example.com/page3"),
  ]);
}
```

ì½œë°±ë³´ë‹¤ëŠ” í”„ë¡œë¯¸ìŠ¤ê°€ ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ì‰½ê³ , íƒ€ì…ì„ ì¶”ë¡ í•˜ê¸°ë„ ì‰½ë‹¤. ìœ„ ì¼€ì´ìŠ¤ë¥¼ ì½œë°±ìœ¼ë¡œ ì§ ë‹¤ë©´ ì¶”ë¡ ì´ ì–´ë µê³  ê°€ë…ì„±ë„ ì¢‹ì§€ ì•Šë‹¤.

```tsx
function timeout(ms: number): Promise<never> {
  return new Promise((resolve) => setTimeout(resolve, ms));
}
async function fetchWithTimeout(url: string, ms: number) {
  // ë°˜í™˜íƒ€ì…ì´ Promise<Response>
  return Promise.race([fetch(url), timeout(ms)]);
}
```

Promise.raceì˜ ë°˜í™˜íƒ€ì…ì€ ì…ë ¥ íƒ€ì…ë“¤ì˜ ìœ ë‹ˆì˜¨ì´ë‹¤. ì´ ê²½ìš°ëŠ” Promise<Response | never> ì´ë¯€ë¡œ, Promise<Response>ê°€ ëœë‹¤ (neverì˜ ìœ ë‹ˆì˜¨ì€ íš¨ê³¼X)

### Promiseë³´ë‹¨ async, await ì‚¬ìš©í•˜ê¸°

ì¼ë°˜ì ìœ¼ë¡  í”„ë¡œë¯¸ìŠ¤ë¥¼ ìƒì„±í•˜ê¸°ë³´ë‹¨ async/awaitì„ ì‚¬ìš©í•´ì•¼ ë” ì§ê´€ì ì¸ ì½”ë“œë¥¼ ì§¤ ìˆ˜ ìˆë‹¤.

asyncí•¨ìˆ˜ëŠ” í•­ìƒ í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜í•˜ë„ë¡ ê°•ì œë˜ì–´ ì¼ê´€ì„± ìˆê²Œ ë¹„ë™ê¸°ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

- Promiseì˜ ë°˜ë™ê¸°(half) ì¼€ì´ìŠ¤

  ```tsx
  const _cache: { [url: string]: string } = {};
  function fetchWithCache(url: string, callback: (text: string) => void) {
    if (url in _cache) {
      callback(_cache[url]); // ë™ê¸°ì  í˜¸ì¶œ
      return;
    }
    fetch(url, (text) => {
      _cache[url] = text;
      callback(text); // ë¹„ë™ê¸°ì  í˜¸ì¶œ
    });
  }

  let requestStatus: "success" | "error" | "loading" = "loading";
  function getUser(id: string) {
    fetchWithCache(`https://example.com/user/${id}`, (profile) => {
      // ğŸ‘ ìºì‹œì¸ê²½ìš°ì—” ë™ê¸°, ìºì‹œXì¸ ê²½ìš°ì—” ë¹„ë™ê¸°ë¡œ ì‘ë™
      requestStatus = "success";
    });
    requestStatus = "loading";
  }
  ```

  - ìºì‹œëœ ê²½ìš°ì—” fetchUrlì´ ë™ê¸°ë¡œ í˜¸ì¶œ, ìºì‹œê°€ ë˜ì§€ ì•Šì€ ê²½ìš°ì—” FetchUrlì´ ë¹„ë™ê¸°ë¡œ í˜¸ì¶œë¨
  - ìºì‹œê°€ ëë‹¤ë©´ requestStatusëŠ” success â†’ loading ìœ¼ë¡œ ë°”ë€Œê²Œë¨!

- asyncí•¨ìˆ˜ë¡œ í•­ìƒ ë¹„ë™ê¸°ì¸ ì½”ë“œ
  ```tsx
  const _cache: { [url: string]: string } = {};
  async function fetchWithCache(url: string) {
    // asyncí•¨ìˆ˜ì´ë¯€ë¡œ ë°˜í™˜íƒ€ì…ì´ Promise<string>
    if (url in _cache) {
      return _cache[url];
    }
    const response = await fetch(url);
    const text = await response.text();
    _cache[url] = text;
    return text;
  }

  let requestStatus: "success" | "error" | "loading" = "loading";
  async function getUser(id: string) {
    requestStatus = "loading";
    const profile = await fetchWithCache(`https://example.com/user/${id}`); // ğŸ‘ ìºì‹œì™€ ìºì‹œX ì¼€ì´ìŠ¤ ëª¨ë‘ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬ë¨
    requestStatus = "success";
  }
  ```
  - asyncí•¨ìˆ˜ëŠ” í•­ìƒ Promiseë¥¼ ë°˜í™˜í•˜ë¯€ë¡œ ë¹„ë™ê¸° ì½”ë“œê°€ ëœë‹¤.
  - ìœ„ì˜ getUserí•¨ìˆ˜ëŠ” í•­ìƒ loadingâ†’successë¡œ ì‘ë™í•œë‹¤!
